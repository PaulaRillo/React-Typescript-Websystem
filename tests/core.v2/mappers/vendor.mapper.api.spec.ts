import { MapperFactory } from '../../../src/core.v2/adapters/mappers/mapper-factory';
import { VendorMapperInterface } from '../../../src/core.v2/adapters/mappers/vendor/vendor-mapper.interface';

describe('VendorMapperApi', () => {
  jest.setTimeout(20000);

  let vendorMapper: VendorMapperInterface;

  beforeAll(async () => {
    const mapperFactory = new MapperFactory();
    vendorMapper = mapperFactory.createVendorMapper();
  });

  test('Should map Vendor', async () => {
    const vendorMapped = vendorMapper.toDomain(vendorDTO);
    expect(vendorMapped.id).toBe('bc15627d-f895-4140-87ea-de2df271e32d');
    expect(vendorMapped.visualId).toBe('515092579');
    expect(vendorMapped.globalVendorId).toBe(undefined);
    expect(vendorMapped.name).toBe('Acme Associates');
    expect(vendorMapped.legalName).toBe(undefined);
    expect(vendorMapped.logoPath).toBe(undefined);
    expect(vendorMapped.sinceAt).toBe('2022-11-16T22:16:44.809Z');
    expect(vendorMapped.billToAddress).toBe('879 Timbersprings Drive');
    expect(vendorMapped.billToZipCode).toBe('15701');
    expect(vendorMapped.mailToAddress).toBe('879 Timbersprings Drive');
    expect(vendorMapped.mailToZipCode).toBe('15701');

    expect(vendorMapped.contacts?.[0].name).toBe('Rena Marrazzo');
    expect(vendorMapped.contacts?.[0].email).toBe('rena.marrazzo@acme.sap.com');
    expect(vendorMapped.contacts?.[0].phone1).toBe('555-0117');
    expect(vendorMapped.contacts?.[0].phone2).toBe(undefined);
    expect(vendorMapped.contacts?.[0].fax).toBe('555-0118');
    expect(vendorMapped.contacts?.[0].mobilePhone1).toBe('555-0181');
    expect(vendorMapped.contacts?.[0].mobilePhone2).toBe(undefined);
    expect(vendorMapped.contacts?.[0].firstName).toBe(undefined);
    expect(vendorMapped.contacts?.[0].lastName).toBe(undefined);
    expect(vendorMapped.contacts?.[0].middleName).toBe(undefined);
    expect(vendorMapped.contacts?.[0].isPrimaryContact).toBe(true);
    expect(vendorMapped.contacts?.[0].profession).toBe(undefined);

    expect(vendorMapped.addresses?.[0].city).toBe('Indiana');
    expect(vendorMapped.bankingInfo?.[0].bankCode).toBe('CITI');
    expect(vendorMapped.bankingInfo?.[0].bankId).toBe(
      '0af4902d-611f-454f-86e7-0723cf79884c'
    );
    expect(vendorMapped.bankingInfo?.[0].accountName).toBe(undefined);
    expect(vendorMapped.bankingInfo?.[0].redactedAccountNumber).toBe('67-5*****2349'); //prettier-ignore
    expect(vendorMapped.accountBalance).toBe(-1310718.9); // prettier-ignore
  });
});

const vendorDTO = {
  id: 'bc15627d-f895-4140-87ea-de2df271e32d',
  global_vendor_id: null,
  trade_name: 'Acme Associates',
  legal_name: null,
  identification_type: null,
  bill_to_address: '879 Timbersprings Drive',
  bill_to_zip_code: '15701',
  mail_to_address: '879 Timbersprings Drive',
  mail_to_zip_code: '15701',
  phone1: '555-0117',
  phone2: null,
  fax: '555-0118',
  notes: null,
  payment_term_id: '95686c5e-d7e1-485d-9e3a-7ef79ce84c83',
  payment_term_external_id: '2',
  credit_limit: '0.000000',
  debt_limit: '0.000000',
  discount_percent: '0.000000',
  vat_status: 1,
  federal_tax_id: 'US16-923440',
  is_liable_for_deductible_at_source: false,
  withholding_tax_deduction_percent: '0.000000',
  withholding_tax_deduction_valid_until: null,
  price_list_id: null,
  price_list_external_id: '1',
  interest_rate: '0.000000',
  free_text: '',
  currency_id: '$',
  mobile_phone1: null,
  mobile_phone2: null,
  average_payment_delay_in_days: null,
  bill_to_city: 'Indiana',
  bill_to_county: 'Indiana County',
  bill_to_country_code: null,
  bill_to_country_external_code: 'US',
  ship_to_city: 'Indiana',
  ship_to_county: 'Indiana County',
  ship_to_country_code: null,
  ship_to_country_external_code: 'US',
  email: 'info@acme.sap.com',
  logo_path: null,
  default_general_ledger_account_id: 'a7305954-f0e4-419c-b388-15f573a61f33',
  default_general_ledger_account_external_id: '_SYS00000000048',
  default_branch_id: null,
  default_branch_external_id: '234',
  default_bank_code: 'CITI',
  external_id2: null,
  parent_company_id: null,
  parent_company_external_id: null,
  foreign_name: null,
  parent_company_type: 1,
  minimum_interest: '0.000000',
  account_balance: '-1310718.900000',
  open_delivery_notes_balance: '-31595.220000',
  open_orders_balance: '-24718.260000',
  open_checks_balance: '0.000000',
  sales_tax_code_id: null,
  sales_tax_code_external_id: null,
  iban: null,
  is_active: true,
  valid_since: null,
  valid_until: null,
  active_status_notes: null,
  is_frozen: false,
  frozen_since: null,
  frozen_until: null,
  frozen_status_notes: null,
  form_1099_external_id: null,
  box_1099_external: null,
  bank_country_code: null,
  bank_country_external_code: 'US',
  house_bank: 'CITI',
  house_bank_country_code: null,
  house_bank_country_external_code: 'US',
  house_bank_account: '300-*****7690',
  requires_single_payment: false,
  is_payment_block: false,
  house_bank_branch: 'Main',
  created_by_external_id: null,
  payment_block_description: '-1',
  payment_block_external_id: null,
  expiration_date: null,
  is_accrual: false,
  project_id: null,
  project_external_id: null,
  website: 'www.acme.sap.com',
  other_general_ledger_account_id: null,
  other_general_ledger_account_external_id: null,
  business_type: 1,
  language_id: null,
  language_external_id: '3',
  profession: null,
  object_to_apply_discounts: null,
  discount_relation: 1,
  industry_external_id: null,
  industry_description: '',
  house_bank_iban: null,
  representative_name: null,
  document_numbering_series_id: null,
  document_numbering_series_external_id: '36',
  blanket_agreement_external_id: null,
  has_no_discounts: false,
  effective_price: 1,
  effective_price_considers_price_before_discount: false,
  edi_sender_id: null,
  edi_recipient_id: null,
  accepts_endorsed_checks: false,
  created_by_external: null,
  exclude_from_marketing_communication: false,
  price_mode: null,
  merchant_id: null,
  legal_text: null,
  is_exchange_rate_for_outgoing_payment: true,
  created_at: '2022-11-16T22:16:44.809Z',
  updated_at: '2022-11-17T21:06:07.498Z',
  created_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
  updated_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
  first_pull_sync_at: '2022-11-16T22:14:18.022Z',
  last_pull_sync_at: '2022-11-17T21:03:47.807Z',
  first_push_sync_at: null,
  last_push_sync_at: null,
  visual_id: '515092579',
  business_partner_group_external_id: '114',
  business_partner_group_id: '00f9a912-0336-4743-bf5e-b5e9052559fc',
  external_id: 'V10000',
  currency_external_id: '$',
  industry_id: null,
  vault_id: 'bc15627d-f895-4140-87ea-de2df271e32d',
  default_processor_id: null,
  default_bank_account_number: '67-5*****2349',
  default_vault_payment_method_id: null,
  vendor_contacts: [
    {
      id: 2,
      external_id: '19',
      global_vendor_id: null,
      vendor_id: 'bc15627d-f895-4140-87ea-de2df271e32d',
      vendor_external_id: 'V10000',
      name: 'Rena Marrazzo',
      position: 'General Manager',
      address: '879 Timbersprings Drive, Indiana, 15701',
      phone1: '555-0117',
      phone2: null,
      mobile_phone1: '555-0181',
      mobile_phone2: null,
      fax: '555-0118',
      email: 'rena.marrazzo@acme.sap.com',
      notes: null,
      birth_place: null,
      birth_date: null,
      gender_id: 2,
      profession: null,
      title: null,
      city_of_birth: null,
      is_active: true,
      first_name: null,
      middle_name: null,
      last_name: null,
      email_group_id: null,
      email_group_external_id: null,
      exclude_from_marketing_communication: false,
      preferred_contact_method: null,
      contact_person_type: null,
      is_primary_contact: true,
      banking_form_pin: null,
      banking_form_access_attempts: null,
      is_blocked_from_banking_form: false,
      created_at: '2022-11-16T22:06:10.931Z',
      updated_at: null,
      created_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
      updated_by: null,
      first_pull_sync_at: '2021-12-08T08:08:00.000Z',
      last_pull_sync_at: '2022-11-17T21:03:47.808Z',
      first_push_sync_at: null,
      last_push_sync_at: null,
      description: 'male',
      gender: { description: 'male' }
    },
    {
      id: 2,
      external_id: '18',
      global_vendor_id: null,
      vendor_id: 'bc15627d-f895-4140-87ea-de2df271e32d',
      vendor_external_id: 'V10000',
      name: 'Sarah Kierl',
      position: 'Account Executive',
      address: '880 Timbersprings Drive, Indiana, 15701',
      phone1: '555-0151',
      phone2: null,
      mobile_phone1: '555-0182',
      mobile_phone2: null,
      fax: '555-0152',
      email: 'sarah.kierl@acme.sap.com',
      notes: null,
      birth_place: null,
      birth_date: null,
      gender_id: 2,
      profession: null,
      title: 1,
      city_of_birth: null,
      is_active: true,
      first_name: null,
      middle_name: null,
      last_name: null,
      email_group_id: null,
      email_group_external_id: null,
      exclude_from_marketing_communication: false,
      preferred_contact_method: null,
      contact_person_type: null,
      is_primary_contact: true,
      banking_form_pin: null,
      banking_form_access_attempts: null,
      is_blocked_from_banking_form: false,
      created_at: '2022-11-16T22:06:10.931Z',
      updated_at: null,
      created_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
      updated_by: null,
      first_pull_sync_at: '2021-12-08T08:08:00.000Z',
      last_pull_sync_at: '2022-11-17T21:03:47.808Z',
      first_push_sync_at: null,
      last_push_sync_at: null,
      description: 'male',
      gender: { description: 'male' }
    }
  ],
  vendor_addresses: [
    {
      id: '16dd65be-b20b-4ba5-8a07-f8ca0f5ebb87',
      external_id: '3155bab15394cc92f576ec2a07c89f8b',
      vendor_id: 'bc15627d-f895-4140-87ea-de2df271e32d',
      vendor_external_id: 'V10000',
      address_1: 'Pay To',
      street: '879 Timbersprings Drive',
      block: null,
      zip_code: '15701',
      city: 'Indiana',
      county: 'Indiana County',
      country_code: null,
      country_external_code: null,
      state: 'PA',
      federal_tax_id: null,
      sales_tax_code_id: null,
      sales_tax_code_external_id: null,
      address_details: '',
      address_type: 2,
      address_2: null,
      address_3: null,
      line_number: 0,
      global_location_number: null,
      nationality: null,
      tax_office: null,
      goods_and_services_tax_identification_number: null,
      goods_and_services_tax_type_external_id: null,
      myf_type: null,
      is_taas_enabled: true,
      created_at: '2022-11-16T22:16:50.642Z',
      updated_at: '2022-11-17T21:06:12.675Z',
      created_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
      updated_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
      first_pull_sync_at: '2022-11-16T22:14:18.022Z',
      last_pull_sync_at: '2022-11-17T21:03:47.807Z',
      first_push_sync_at: null,
      last_push_sync_at: null
    },
    {
      id: 'f92a21b5-06a7-49c1-95f8-543e1bf692e5',
      external_id: '451ab2038ad21cdc8a23730a71ac897b',
      vendor_id: 'bc15627d-f895-4140-87ea-de2df271e32d',
      vendor_external_id: 'V10000',
      address_1: 'Ship to',
      street: '879 Timbersprings Drive',
      block: null,
      zip_code: '15701',
      city: 'Indiana',
      county: 'Indiana County',
      country_code: null,
      country_external_code: null,
      state: 'PA',
      federal_tax_id: 'US16-923440',
      sales_tax_code_id: null,
      sales_tax_code_external_id: null,
      address_details: '',
      address_type: 1,
      address_2: null,
      address_3: null,
      line_number: 1,
      global_location_number: null,
      nationality: null,
      tax_office: null,
      goods_and_services_tax_identification_number: null,
      goods_and_services_tax_type_external_id: null,
      myf_type: null,
      is_taas_enabled: true,
      created_at: '2022-11-16T22:16:50.662Z',
      updated_at: '2022-11-17T21:06:12.696Z',
      created_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
      updated_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
      first_pull_sync_at: '2022-11-16T22:14:18.022Z',
      last_pull_sync_at: '2022-11-17T21:03:47.807Z',
      first_push_sync_at: null,
      last_push_sync_at: null
    }
  ],
  vendor_notes: [],
  vendor_banking_info: [
    {
      id: '1d514631-9c55-451b-bf77-7ffcf61316b0',
      external_id: '9',
      vendor_id: 'bc15627d-f895-4140-87ea-de2df271e32d',
      vendor_external_id: 'V10000',
      bank_code: 'CITI',
      account_name: null,
      bank_identifier_code: null,
      aba_routing_number: null,
      customer_id_number: '0',
      correspondent_account: null,
      country_id: null,
      country_external_id: 'US',
      county: null,
      state: null,
      iban: null,
      zip_code: null,
      city: 'Manchester',
      block: null,
      branch: '234',
      street: null,
      control_key: null,
      building_floor_room: '',
      user1: null,
      user2: null,
      user3: null,
      user4: null,
      log_instance: '0',
      bik: null,
      phone: null,
      fax: null,
      isr_biller_id: null,
      isr_type: 2,
      mandate_id: null,
      signature_date: null,
      mandate_expiration_date: null,
      sepa_seq_type: null,
      payment_gateway_id: null,
      created_at: '2022-11-17T21:03:47.808Z',
      updated_at: '2022-11-17T21:06:22.663Z',
      created_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
      updated_by: '5790c9ca-d393-4411-afba-a7976ccf4647',
      first_pull_sync_at: '2022-11-16T22:14:18.022Z',
      last_pull_sync_at: '2022-11-17T21:03:47.808Z',
      first_push_sync_at: null,
      last_push_sync_at: '2022-11-17T21:03:47.808Z',
      currency_id: null,
      vault_payment_method_id: null,
      redacted_account_number: '67-5*****2349',
      bank_id: '0af4902d-611f-454f-86e7-0723cf79884c'
    }
  ]
};
